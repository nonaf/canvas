var nonafCanvas=function(){"use strict";function t(t,n,o){return Math.min(o,Math.max(n,t))}function n(n){function o(o){var a=n.canvas,i=n.size,e=n.zoomFactor,r=n.rotation,c=a.width,u=c/i.width,h=i.height*u,s=0,f=0,m=c,l=h;1!=r&&3!=r||(m=h=c*c/h,l=c),1==r?s=l*e:2==r?(s=m*e,f=l*e):3==r&&(f=m*e),n.ratio=u,n.canvasWidth=Math.round(c),n.canvasHeight=Math.round(h),n.paintWidth=Math.round(m*e),n.paintHeight=Math.round(l*e),n.noBounds||(0==r||2==r?(n.left=t(n.left,n.canvasWidth-n.paintWidth,0),n.top=t(n.top,n.canvasHeight-n.paintHeight,0)):(n.left=t(n.left,n.canvasWidth-n.paintHeight,0),n.top=t(n.top,n.canvasHeight-n.paintWidth,0))),n.tX=s,n.tY=f,o&&n.draw()}return o(),{calculateDim:o}}function o(t){function n(n,o){var a=t.canvas,i=t.canvasWidth,e=t.canvasHeight,r=t.viewBox,c=t.zoomFactor,u=t.left,h=t.top,s=t.rotation,f=a.getBoundingClientRect(),m=r.width/i,l=n-f.left,d=o-f.top,v=l,p=d;return 1!=s&&3!=s||(m=r.width/e),1==s?(d=i*c-l+u,l=p-h):2==s?(l=i*c-l+u,d=e*c-d+h):3==s?(l=e*c-d+h,d=v-u):(l-=u,d-=h),[Math.round(r.x+l*m/c),Math.round(r.y+d*m/c)]}function o(n,o){var a=t.canvasWidth,i=t.canvasHeight,e=t.size,r=t.zoomFactor,c=t.rotation,u=a/e.width;return 1!=c&&3!=c||(u=i/e.width),[n*u*r,o*u*r]}return{normalizePoint:n,normalizePointList:function(t){return t.map(function(t){return n(t[0],t[1])})},denormalizePoint:o,denormalizePointList:function(t){return t.map(function(t){return o(t[0],t[1])})}}}function a(t){return{transform:function(n){var o=t.tX,a=t.tY,i=t.left,e=t.top,r=t.rotations,c=t.rotation;n instanceof Element?n.style.transform="translate("+i+"px,"+e+"px) rotate("+r[c]+"rad)":(n.setTransform(1,0,0,1,0,0),n.translate(o+i,a+e),n.rotate(r[c]))}}}function i(t,n,o){function a(a,i){var e,c,u=t.zoomCenter,h=t.zoomFactor;e=n.denormalizePoint(u[0],u[1]),r=Math.min(5e3,Math.max(5,a)),t.zoomFactor=r/100,i||t.zoomFactor==h||(o.calculateDim(),c=n.denormalizePoint(u[0],u[1]),t.left-=c[0]-e[0],t.top-=c[1]-e[1]),o.calculateDim(1)}function i(n){r>120&&(n*=t.zoomFactor),a(r+n)}function e(t,n){void 0===n&&(n=1),i(n*t),s.run(20,function(n){e(t,n)})}var r=100*t.zoomFactor;return{setZoom:a,resetZoom:function(){r=100,t.zoomFactor=1,o.calculateDim(1)},changeZoom:i,startZoom:e,getZoom:function(){return r}}}function e(t,n){function o(o,a){"left"==o||"right"==o?t.left+=a*("left"==o?1:-1):t.top+=a*("up"==o?1:-1),n.calculateDim(1)}function a(t,n){o(t,n=n||1),s.run(20,function(n){a(t,n)})}return{setPan:function(n,o){t.left=n,t.top=o},changePan:o,startPan:a}}function r(t,n,o,a){return{reset:function(){t.left=0,t.top=0,t.tX=0,t.tY=0,t.rotation=0,a.resetZoom()},rotate:function(n){var o=t.rotation,i=t.rotations,e=t.size;(o+=n)<0?o=i.length-1:o>=i.length&&(o=0),t.rotation=o;var r=a.getZoom();o%2==1?a.setZoom(r*e.height/e.width,!0):a.setZoom(r*e.width/e.height,!0)},stopAction:function(){s.stop()},setCenter:function(o,a){t.zoomCenter=n.normalizePoint(o,a)}}}var c,u=200,h=1,s={run:function(t,n){clearTimeout(c),c=setTimeout(function(){h+=.4,u=Math.max(u-50,t),n(Math.min(20,Math.round(h)))},u)},stop:function(){u=200,h=1,clearTimeout(c)}};return function(t){var c=t.canvas,u=t.size,h=t.viewBox,s={canvas:c,size:u,viewBox:h,draw:t.draw,noBounds:t.noBounds,ctx:c.getContext("2d"),rotations:[0,Math.PI/2,Math.PI,-Math.PI/2],rotation:0,zoomFactor:1,left:0,top:0,zoomCenter:[h.width/2,h.height/2]},f=o(s),m=n(s),l=a(s),d=i(s,f,m),v=e(s,m),p=r(s,f,m,d);return Object.assign(s,f,m,l,d,v,p)}}();