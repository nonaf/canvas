var nonafCanvas=function(){"use strict";function t(t,n,o){return Math.min(o,Math.max(n,t))}function n(n){function o(o){var i=n.canvas,a=n.size,e=n.zoomFactor,r=n.rotation,c=i.width,u=c/a.width,h=a.height*u,f=0,s=0,m=c,d=h;1!=r&&3!=r||(m=h=c*c/h,d=c),1==r?f=d*e:2==r?(f=m*e,s=d*e):3==r&&(s=m*e),n.ratio=u,n.canvasWidth=Math.round(c),n.canvasHeight=Math.round(h),n.paintWidth=Math.round(m*e),n.paintHeight=Math.round(d*e),n.noBounds||(0==r||2==r?(n.left=t(n.left,n.canvasWidth-n.paintWidth,0),n.top=t(n.top,n.canvasHeight-n.paintHeight,0)):(n.left=t(n.left,n.canvasWidth-n.paintHeight,0),n.top=t(n.top,n.canvasHeight-n.paintWidth,0))),n.tX=f,n.tY=s,o&&n.draw()}return o(),{calculateDim:o}}function o(t){function n(n,o){var i=t.canvas,a=t.viewBox,e=t.zoomFactor,r=t.left,c=t.top,u=t.rotation,h=i.getBoundingClientRect(),f=a.width/i.width,s=n-h.left,m=o-h.top,d=s,l=m;return 1!=u&&3!=u||(f=a.width/i.height),1==u?(m=i.width*e-s+r,s=l-c):2==u?(s=i.width*e-s+r,m=i.height*e-m+c):3==u?(s=i.height*e-m+c,m=d-r):(s-=r,m-=c),[Math.round(a.x+s*f/e),Math.round(a.y+m*f/e)]}function o(n,o){var i=t.canvas,a=t.size,e=t.zoomFactor,r=t.rotation,c=i.width/a.width;return 1!=r&&3!=r||(c=i.height/a.width),[n*c*e,o*c*e]}return{normalizePoint:n,normalizePointList:function(t){return t.map(function(t){return n(t[0],t[1])})},denormalizePoint:o,denormalizePointList:function(t){return t.map(function(t){return o(t[0],t[1])})}}}function i(t){return{transform:function(n){var o=t.tX,i=t.tY,a=t.left,e=t.top,r=t.rotations,c=t.rotation;n instanceof Element?n.style.transform="translate("+a+"px,"+e+"px) rotate("+r[c]+"rad)":(n.setTransform(1,0,0,1,0,0),n.translate(o+a,i+e),n.rotate(r[c]))}}}function a(t,n,o){function i(i,a){var e,c,u=t.zoomCenter,h=t.zoomFactor;e=n.denormalizePoint(u[0],u[1]),r=Math.min(5e3,Math.max(5,i)),t.zoomFactor=r/100,a||t.zoomFactor==h||(o.calculateDim(),c=n.denormalizePoint(u[0],u[1]),t.left-=c[0]-e[0],t.top-=c[1]-e[1]),o.calculateDim(1)}function a(n){r>120&&(n*=t.zoomFactor),i(r+n)}function e(t,n){void 0===n&&(n=1),a(n*t),f.run(20,function(n){e(t,n)})}var r=100*t.zoomFactor;return{setZoom:i,resetZoom:function(){r=100,t.zoomFactor=1,o.calculateDim(1)},changeZoom:a,startZoom:e,getZoom:function(){return r}}}function e(t,n){function o(o,i){"left"==o||"right"==o?t.left+=i*("left"==o?1:-1):t.top+=i*("up"==o?1:-1),n.calculateDim(1)}function i(t,n){o(t,n=n||1),f.run(20,function(n){i(t,n)})}return{setPan:function(n,o){t.left=n,t.top=o},changePan:o,startPan:i}}function r(t,n,o,i){return{reset:function(){t.left=0,t.top=0,t.tX=0,t.tY=0,t.rotation=0,i.resetZoom()},rotate:function(n){var o=t.rotation,a=t.rotations,e=t.size;(o+=n)<0?o=a.length-1:o>=a.length&&(o=0),t.rotation=o;var r=i.getZoom();o%2==1?i.setZoom(r*e.height/e.width,!0):i.setZoom(r*e.width/e.height,!0)},stopAction:function(){f.stop()},setCenter:function(o,i){t.zoomCenter=n.normalizePoint(o,i)}}}var c,u=200,h=1,f={run:function(t,n){clearTimeout(c),c=setTimeout(function(){h+=.4,u=Math.max(u-50,t),n(Math.min(20,Math.round(h)))},u)},stop:function(){u=200,h=1,clearTimeout(c)}};return function(t){var c=t.canvas,u=t.size,h=t.viewBox,f={canvas:c,size:u,viewBox:h,draw:t.draw,noBounds:t.noBounds,ctx:c.getContext("2d"),rotations:[0,Math.PI/2,Math.PI,-Math.PI/2],rotation:0,zoomFactor:1,left:0,top:0,zoomCenter:[h.width/2,h.height/2]},s=o(f),m=n(f),d=i(f),l=a(f,s,m),v=e(f,m),p=r(f,s,m,l);return Object.assign(f,s,m,d,l,v,p)}}();